name: Macros
description: Macros into Javascript
host: EXCEL
api_set: {}
script:
  content: |
    $("#sort_invoice").click(() => tryCatch(run_sort_invoice));

    $("#schedule_rollover").click(() => tryCatch(run_schedule_rollover));

    function Sort_Invoices(context) {
      var sheet = context.workbook.worksheets.getItem("Invoices");

      var rang1 = sheet.getRange("A5:K50");
      //sorting
      rang1.sort.apply([
        {
          key: 0,
          ascending: true
        }
      ]);

      var rang2 = sheet.getRange("A53:K63");
      rang2.sort.apply([
        {
          key: 0,
          ascending: true
        }
      ]);
    }

    function Schedule_Rollover(context) {
      var next_weeks_schedule = context.workbook.worksheets.getItem("Next Weeks Schedule");

      var current_sechdule = context.workbook.worksheets.getItem("Current Schedule");

      var next_week = next_weeks_schedule.getRange("A8:V65");
      var Current_se = current_sechdule.getRange("A8");
      Current_se.copyFrom(next_week, "All", false, false);

      next_week = next_weeks_schedule.getRange("C70:V70");
      Current_se = current_sechdule.getRange("C70:D70");
      Current_se.copyFrom(next_week, "All", false, false);

      next_week = next_weeks_schedule.getRange("C74:D74");
      Current_se = current_sechdule.getRange("C74:D74");
      Current_se.copyFrom(next_week, "All", false, false);

      next_week = next_weeks_schedule.getRange("I74:J74");
      Current_se = current_sechdule.getRange("I74:J74");
      Current_se.copyFrom(next_week, "All", false, false);
    }
    function New_Week() {}
    function New_Period() { }

    async function run_sort_invoice() {
      await Excel.run(async (context) => {
        //function call
        Sort_Invoices(context);

        return context.sync().then(function() {
          console.log("Rangs have been sorted successfully");
        });

        await context.sync();
      });
    }

    async function run_schedule_rollover() {
      await Excel.run(async (context) => {
        //function call
        Schedule_Rollover(context);

        return context.sync().then(function () {
          console.log("Next weeks schedule has been moved to current schedule successfully");
        });

        await context.sync();
      });
    }

    async function tryCatch(callback) {
      try {
        await callback();
      } catch (error) {
        console.error(error);
      }
    }
  language: typescript
template:
  content: |-
    <button id="sort_invoice" class="ms-Button">
        <span class="ms-Button-label">Sort Invoices</span>
    </button>
    </br>
    <button id="schedule_rollover" class="ms-Button">
        <span class="ms-Button-label">Schedule_Rollover</span>
    </button>
  language: html
style:
  content: |-
    section.samples {
        margin-top: 20px;
    }

    .ms-Button{
      margin-top: 10px;
    }

    section.samples .ms-Button, section.setup .ms-Button {
        display: block;
        margin-bottom: 5px;
        margin-left: 20px;
        min-width: 80px;
        background: blue;
        color: white;
    }
  language: css
libraries: |
  https://appsforoffice.microsoft.com/lib/1/hosted/office.js
  @types/office-js

  office-ui-fabric-js@1.4.0/dist/css/fabric.min.css
  office-ui-fabric-js@1.4.0/dist/css/fabric.components.min.css

  core-js@2.4.1/client/core.min.js
  @types/core-js

  jquery@3.1.1
  @types/jquery@3.3.1
